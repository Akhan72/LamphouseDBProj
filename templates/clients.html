<!doctype html>

<!-- This is the Clients List paage
 This displays all clients from the database in a table format. Which includes
 options to edit or delete each client. There are also links to return to the dashboard.
 This is the main READ view in the CRUD cycle for managing clients.

-->

<html>
<head>
    <title>Clients</title>
</head>
<body>
    <h1>Clients</h1>

    <!-- flash messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <ul>
        {% for category, message in messages %}
          <li><strong>{{ category }}:</strong> {{ message }}</li>
        {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <p>
        <a href="{{ url_for('dashboard') }}">Back to Dashboard</a> |
        <a href="{{ url_for('new_client') }}">Add New Client</a>
    </p>

    <table border="1" cellpadding="5">
        <tr>
            <th>ID</th>
            <th>First</th>
            <th>Last</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Actions</th>
        </tr>
        {% for c in clients %}
        <tr>
            <td>{{ c["client_id"] }}</td>
            <td>{{ c["first_name"] }}</td>
            <td>{{ c["last_name"] }}</td>
            <td>{{ c["email"] }}</td>
            <td>{{ c["phone"] }}</td>
            <td>
                <a href="{{ url_for('edit_client', client_id=c['client_id']) }}">Edit</a>

                <!-- Delete form -->
                 <!--
                This POST form calls the delete_client route to remove 
                the client record from the database and asks for 
                confirmation in the browser.
                 -->
                <form action="{{ url_for('delete_client', client_id=c['client_id']) }}"
                      method="post" style="display:inline;">
                    <button type="submit" onclick="return confirm('Delete this client?');">
                        Delete
                    </button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>
</body>
</html>
